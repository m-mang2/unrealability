![image](https://github.com/m-mang2/unrealability/assets/135841268/ae73c784-456d-4b9a-a224-9fb067e44f96)

# Gameplay Cue(GC)

시각 이펙트나 사운드같은 게임로직과 무관한 기능

데디케이티드 서버에서는 사용하지 않음

**스태틱 게임 플레이큐** : 일시적 특수효과. Execute 이벤트 (GameplayCueNotify_Actor : 일정시간 동안 발생)

**액터 게임 플레이큐** : 일정 시간동안 발생 add/remove (GameplayCueNotify_Static : 일시적 발생)

블루프린트로 제작이 더 생산적

게임플레이 이펙트에서 자동으로 GC와 연동할 수 있도록 기능 제공

게임플레이 큐는 GameplayCueManager가 관리함

게임 플레이 태그에서 쉽게 발동, 이때는 **GameplayCue**로 시작하는 게임 플레이 태그를 사용 (이미 만들어져 있음)



#### 의문
```
	/*
		이거 였는데 갑자기..?
		Called when a GameplayCue is executed, this is used for instant effects or periodic ticks
		UFUNCTION(BlueprintNativeEvent, BlueprintPure, Category = "GameplayCueNotify")
		bool OnExecute(AActor* MyTarget, const FGameplayCueParameters& Parameters) const;
	*/
	virtual bool OnExecute_Implementation(AActor* MyTarget, const FGameplayCueParameters& Parameters) const override;
```

BlueprintNativeEvent키워드가 있을 경우 언리얼 내부적으로 _Implementation를 붙여줌


```
UPROPERTY(EditAnywhere, Category=GAS, Meta=(Categories=GameplayCue))
FGameplayTag GameplayCueTag;
```
![image](https://github.com/m-mang2/unrealability/assets/135841268/f3122686-47fd-4b3e-b4b3-9673e4634dcf)

Meta=(Categories=GameplayCue) 옵션을 넣어주면 에디터에서 GameplayCue로 시작하는 태그만 볼 수 있음


![image](https://github.com/m-mang2/unrealability/assets/135841268/17f31ded-353a-4b19-b634-d7b1626d4a8b)

# 2초동안 체력을 채우고싶을때 옵션

Duration Magnitude 2초

Scalable Float Magnitude 2

Period 2초

총 18의 체력이 회복(시작하자마자 2회복 0.25초마다 2씩 8번 회복)

**의문점은 Period를 안넣으면 2가 즉시 올랐다가 2초후에 다시 내려감**

이 기능을 사용 하면 도트 데미지도 쉽게 구현 가능

Health대신 Damage로 바꾸면 도트데미지가 완성

# GameplayEffect에서 GameplayCue 연동?

1. GameplayEffect에서 GameplayCue옵션에 태그 값을 설정해줌
![image](https://github.com/m-mang2/unrealability/assets/135841268/b031b7bb-97d3-4af1-8c5d-2d31ac5f9533)

2. Cue에 태그값이 GameplayCue.Character.Damage로 변경되면 해당 블루프린트 실행
![image](https://github.com/m-mang2/unrealability/assets/135841268/462c29ab-f30c-4692-8288-3e96dd58a431)


# GamePlayTag 추가
![image](https://github.com/m-mang2/unrealability/assets/135841268/a07b2d1f-cc0c-4d82-9211-c7047109b855)

# GamePlayTag 제거
![image](https://github.com/m-mang2/unrealability/assets/135841268/03c87cc6-3c4b-42f5-8c2a-b4fe94d79119)

# 무기 만들기
1. 상자에서 SendGameplayEventToActor를 통하여 캐릭터에게 이벤트를 보냄
   WeaponEventTag에는 Event.Character.Wepone.Equip가 설정되어있음
```
void AABGASWeaponBox::NotifyActorBeginOverlap(AActor* Other)
{
	Super::NotifyActorBeginOverlap(Other);
	UAbilitySystemBlueprintLibrary::SendGameplayEventToActor(Other, WeaponEventTag, FGameplayEventData());// Other가 플레이어니까 이쪽으로 이벤트가 감, 받기 위해서는 콜백 함수를 설정해야함
}
```
2. 캐릭터에서 Event.Character.Wepone.Equip의 값이 변경되면 콜백함수가 호출되도록 설정
```
ASC->GenericGameplayEventCallbacks.FindOrAdd(ABTAG_EVENT_CHARACTER_WEAPONEQUIP).AddUObject(this, &AABGASCharacterPlayer::EquipWeapon);

void AABGASCharacterPlayer::EquipWeapon(const FGameplayEventData* EventData)
{
	if (Weapon && WeaponMesh)
	{
		Weapon->SetSkeletalMesh(WeaponMesh);
		// 바람직한 방법은 아니나...이런것도 있다.. 이펙트 사용할것
		const float CurrentAttackRange = ASC->GetNumericAttributeBase(UABCharacterAttributeSet::GetAttackRangeAttribute());
		const float CurrentAttackRate = ASC->GetNumericAttributeBase(UABCharacterAttributeSet::GetAttackRateAttribute());

		ASC->SetNumericAttributeBase(UABCharacterAttributeSet::GetAttackRangeAttribute(), CurrentAttackRange + WeaponRange);
		ASC->SetNumericAttributeBase(UABCharacterAttributeSet::GetAttackRateAttribute(), CurrentAttackRate + WeaponAttackRate);
	}
}
```

# 진짜 의문..
태그 디버깅 어떻게하지..?

값을 블루프린트에서 태그 설정을 잘못해서 다른값이 바꼈는데... 찾을수가 없다...


